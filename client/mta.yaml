_schema-version: '3.1'
ID: client
version: 1.1.0
parameters:
    enable-parallel-deployments: true

build-parameters:
    before-all:
        - builder: custom
          commands:
              - npm ci
              - npx -p @sap/cds-dk cds build --production

modules:
    - name: client
      type: nodejs
      path: gen/srv
      parameters:
          buildpack: nodejs_buildpack
      build-parameters:
          builder: npm-ci
      requires:
          - name: destination-service
          - name: xsuaa-client-service
      provides:
          - name: srv-api
            properties:
                url: ${default-url}

resources:
    - name: destination-service
      type: org.cloudfoundry.managed-service
      parameters:
          service: destination
          service-name: destination-service
          service-plan: lite
    - name: xsuaa-client-service
      type: org.cloudfoundry.managed-service
      parameters:
          service: xsuaa
          service-plan: application
          service-name: xsuaa-client-service
